> [8. Aplicaci√≥n de Patrones Arquitecturales](../8.md) ‚Ä∫ [8.3. M√≥dulo 3 / Integrante 3](8.3.md)

# 8.3. M√≥dulo 3 / Integrante 3

## Patr√≥n de M√≥dulo

**T√≠tulo:** 

Elecci√≥n del patr√≥n de m√≥dulo para el m√≥dulo de Gesti√≥n de Usuarios y Seguridad

**Contexto:**

El m√≥dulo gestiona tanto usuarios internos como externos, manejando autenticaci√≥n, permisos, roles, sesiones y registrar los logs. Requiere alta mantenibilidad, seguridad y separaci√≥n clara entre la l√≥gica de negocio, la presentaci√≥n y la persistencia de datos.

**Alternativas:**

- **Arquitectura por capas**: Divide el sistema en capas (Presentaci√≥n, Aplicaci√≥n, Dominio, Infraestructura).

- **Arquitectura modular monol√≠tica:** Mantener un monolito dividido internamente en m√≥dulos cohesivos.

**Criterios de elecci√≥n:**

- Separaci√≥n clara de responsabilidades.
- Facilidad de pruebas unitarias e integraci√≥n.
- Escalabilidad futura sin complejidad inicial.
- Cumplimiento de atributos de calidad: mantenibilidad, testabilidad, seguridad.

**Decisi√≥n:**

Adoptar arquitectura por capas dentro de un monolito modular, donde el m√≥dulo de Gesti√≥n de Usuarios se compone de:

- Capa de Presentaci√≥n (API/Login UI)
- Capa de Aplicaci√≥n (Casos de uso: autenticaci√≥n, registro, recuperaci√≥n)
- Capa de Dominio (entidades, reglas de roles, validaciones de contrase√±a)
- Capa de Infraestructura (repositorios, integraci√≥n con DB y servicios externos)

**Sustento:**

El patr√≥n por capas facilita la separaci√≥n l√≥gica de la autenticaci√≥n, los flujos de sesi√≥n y el registro de logs, permitiendo que el m√≥dulo mantenga alta mantenibilidad y testabilidad. Adem√°s, simplifica la evoluci√≥n hacia servicios independientes si se requiere escalar.

--- 

## Patr√≥n de Componente y Conector

**T√≠tulo:** 

Elecci√≥n para la interacci√≥n del m√≥dulo de usuarios

**Contexto:**

El m√≥dulo requiere comunicaci√≥n entre el portal web (pacientes y personal cl√≠nico) y el backend de autenticaci√≥n, adem√°s de notificar a otros m√≥dulos sobre inicios y cierres de sesi√≥n.

**Alternativas:**

- **Cliente-Servidor:** Comunicaci√≥n directa v√≠a API REST entre frontend y backend.

- **Publicar/Suscribir:** Emisi√≥n de eventos (login, logout, fallas) a un bus de mensajer√≠a (RabbitMQ/Kafka).

- **Modelo Vista-Controlador (MVC):** Separaci√≥n entre interfaz y l√≥gica, pero sin integraci√≥n de eventos entre m√≥dulos.

**Criterios de elecci√≥n:**

- Simplicidad para autenticaci√≥n s√≠ncrona (tiempo real).

- Integraci√≥n con otros m√≥dulos (Registro de Accesos).

- Soporte para eventos as√≠ncronos de seguridad.

- Escalabilidad en escenarios con m√∫ltiples usuarios concurrentes.

**Decisi√≥n:**

Adoptar un modelo h√≠brido Cliente-Servidor + Publicar/Suscribir:

- Cliente-Servidor (REST): usado para autenticaci√≥n, registro, gesti√≥n de sesiones y recuperaci√≥n de contrase√±as.

- Publicar/Suscribir (mensajer√≠a as√≠ncrona): para emitir eventos de registro de accesos (login/logout).

**Sustento:**

Este patr√≥n compuesto permite que las operaciones cr√≠ticas (autenticaci√≥n, login) se manejen de forma s√≠ncrona y confiable, mientras que las tareas de monitoreo de logs se gestionen as√≠ncronamente, mejorando el rendimiento y la interoperabilidad (atributos definidos en RF6, RF10, RF13).

---

## Patr√≥n de Asignaci√≥n

**T√≠tulo:**

Separaci√≥n f√≠sica de capas para reforzar la seguridad del m√≥dulo de autenticaci√≥n.

**Contexto:**

El m√≥dulo debe asegurar la protecci√≥n de credenciales, el cumplimiento de pol√≠ticas de contrase√±as y la disponibilidad del servicio. Es necesario separar responsabilidades en distintos niveles de infraestructura.

**Alternativas:**

- Single-tier (monolito en un solo servidor): Simplifica el despliegue, pero reduce seguridad.

- Multi-tier (3 niveles: presentaci√≥n, aplicaci√≥n, base de datos): Aisla l√≥gicamente cada componente.

**Criterios de elecci√≥n:**

- Seguridad de credenciales y datos sensibles.
- Aislamiento ante fallos.
- Compatibilidad con despliegue en nube o contenedores.
- Escalabilidad y mantenibilidad.

**Decisi√≥n:**

Adoptar arquitectura Multi-Tier con las siguientes capas f√≠sicas:

- Capa de presentaci√≥n (Frontend / Portal Web) ‚Äî desplegada en un servidor web o CDN.

- Capa de aplicaci√≥n (API de autenticaci√≥n y gesti√≥n de usuarios) ‚Äî desplegada en contenedores (Docker / Kubernetes).

- Capa de datos (PostgreSQL con JSONB) ‚Äî desplegada en un nodo seguro y replicado.

**Sustento:**

Esta configuraci√≥n permite aislar datos sensibles, mantener la disponibilidad del servicio de login (99%). Adem√°s, soporta escalabilidad horizontal del backend para manejar m√∫ltiples usuarios concurrentes.

## Patr√≥n de dise√±o Cloud

**T√≠tulo:**

Habilitaci√≥n de autenticaci√≥n federada en complemento al login institucional

**Contexto:**

El m√≥dulo de Gesti√≥n de Usuarios y Seguridad debe autenticar a usuarios internos y externos.
Actualmente, el sistema ya considera un mecanismo de autenticaci√≥n tradicional basado en credenciales institucionales (correo y contrase√±a).

Sin embargo, algunos usuarios ‚Äîespecialmente pacientes‚Äî podr√≠an beneficiarse de un inicio de sesi√≥n simplificado utilizando proveedores conocidos como Google, lo cual reduce fricci√≥n al acceder al portal de pacientes y disminuye la cantidad de contrase√±as que los usuarios deben recordar.

El uso de autenticaci√≥n federada tambi√©n implica que el sistema cl√≠nico gestiona menos datos sensibles (por ejemplo, contrase√±as), reduciendo riesgos de seguridad y carga operativa.

**Alternativas:**

1. Autenticaci√≥n interna √∫nicamente:
Uso exclusivo de credenciales creadas en el ERP cl√≠nico.
- Ventajas:
    -  Control completo del proceso.
    - Pol√≠ticas de contrase√±as totalmente gestionadas por la cl√≠nica.
- Desventajas:
    - Mayor carga de soporte (olvido de contrase√±as).
    - Mayor responsabilidad en almacenamiento seguro de credenciales.
    - Menor comodidad para usuarios externos.

2. Autenticaci√≥n federada opcional:
Se mantiene el login institucional, pero se habilita un flujo alternativo usando Google como proveedor OIDC.

- Ventajas:
    - Mejora la usabilidad para pacientes/usuarios externos.
    - Reduce la necesidad de almacenar contrase√±as locales.
    - Delegaci√≥n de seguridad a un proveedor robusto (Google).
    - Menor fricci√≥n para accesos recurrentes.

- Desventajas:
    - Mayor complejidad en la integraci√≥n inicial.
    - Dependencia parcial de un proveedor externo.


**Criterios de elecci√≥n:**

- Implementaci√≥n progresiva sin reemplazar el login institucional.
- Reducci√≥n de manejo de datos altamente sensibles.
- Mejor experiencia de usuario para pacientes.
- Cumplimiento con est√°ndares OAuth 2.0 y OpenID Connect.
- Mantenimiento m√°s sencillo del sistema de autenticaci√≥n.

**Decisi√≥n:**

Se adopta el patr√≥n Identidad Federada mediante la integraci√≥n opcional de Google Identity.
El sistema ofrecer√° dos caminos de autenticaci√≥n:
- Login tradicional (credenciales del ERP cl√≠nico).
- Login federado con Google mediante OIDC.

El backend verificar√° los tokens JWT emitidos por Google antes de otorgar acceso. No se reemplaza el sistema interno, solo se complementa para aumentar la accesibilidad y seguridad del m√≥dulo.


**Sustento:**

Se aprovechan las capacidades de Google Identity mediante OpenID Connect (OIDC) como proveedor externo de autenticaci√≥n. En t√©rminos de seguridad, permite reducir la exposici√≥n y manejo de contrase√±as locales dentro del sistema cl√≠nico, delegando la validaci√≥n de credenciales a un servicio altamente protegido y certificado. Desde la perspectiva de fiabilidad, la autenticaci√≥n se apoya en la infraestructura robusta y redundante de Google, garantizando continuidad incluso ante fallos locales del ERP. Finalmente, en cuanto a eficiencia del rendimiento, el uso de tokens OIDC optimizados y mecanismos de verificaci√≥n ligeros posibilita un flujo de autenticaci√≥n m√°s r√°pido, minimizando la carga sobre el backend.




---

[‚¨ÖÔ∏è Anterior](../8.2/8.2.md) | [üè† Home](../../README.md) | [Siguiente ‚û°Ô∏è](../8.4/8.4.md)