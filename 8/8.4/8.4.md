> [8. Aplicaci√≥n de Patrones Arquitecturales](../8.md) ‚Ä∫ [8.4. M√≥dulo 4 / Integrante 4](8.4.md)

# 8.4. M√≥dulo 4 / Integrante 4

# Decisiones de Arquitectura - M√≥dulo de Inventarios

## Patr√≥n de M√≥dulo

### T√≠tulo
Elecci√≥n del patr√≥n de m√≥dulo para el m√≥dulo de Inventarios

### Contexto
El m√≥dulo gestiona el control de inventarios, stock disponible, fecha de vencimiento de insumos, las alertas de stock bajo, y la integraci√≥n con sistemas de compras. Requiere alta disponibilidad, eficiencia en la gesti√≥n de datos, flexibilidad para adaptarse a distintas categor√≠as de productos y facilidad de monitoreo.

### Alternativas

- **Arquitectura por capas**: Divide el sistema en capas (Presentaci√≥n, Aplicaci√≥n, Dominio, Infraestructura).
- **Arquitectura modular monol√≠tica**: Mantener un monolito dividido internamente en m√≥dulos cohesivos.

### Criterios de elecci√≥n

- **Separaci√≥n clara de responsabilidades**: Debe haber distinci√≥n entre la l√≥gica de negocio, la presentaci√≥n de datos y la persistencia de la informaci√≥n.
- **Facilidad de pruebas unitarias e integraci√≥n**: El m√≥dulo debe ser f√°cil de probar, permitiendo validar cada funcionalidad de forma aislada.
- **Escalabilidad futura sin complejidad inicial**: Si el negocio crece y la gesti√≥n de inventarios se vuelve m√°s compleja, el sistema debe permitir expansi√≥n sin un redise√±o mayor.
- **Cumplimiento de atributos de calidad**: Mantenibilidad, rendimiento, facilidad para adaptarse a cambios y seguridad en las operaciones de inventario.

### Decisi√≥n
Adoptar **arquitectura por capas** dentro de un monolito modular, donde el m√≥dulo de Gesti√≥n de Inventarios se compone de:

- **Capa de Presentaci√≥n**: Interfaz de usuario de inventarios, API para consultar insumos, consultar stock, a√±adir insumos
- **Capa de Aplicaci√≥n**: Casos de uso: registrar productos, actualizar inventarios, generar alertas de stock bajo, generar alertas por fecha de vencimiento
- **Capa de Dominio**: Entidades: Producto, Alerta de Stock, Ubicaci√≥n, validaci√≥n de productos en el inventario
- **Capa de Infraestructura**: Repositorios para interactuar con la base de datos, APIs para comunicaci√≥n con m√≥dulo de compras

### Sustento
La arquitectura por capas proporciona una separaci√≥n clara de las responsabilidades, permitiendo que el flujo de productos y datos se maneje de manera independiente a la l√≥gica de presentaci√≥n y almacenamiento. Esto facilita las actualizaciones futuras y las pruebas, manteniendo el m√≥dulo flexible para adaptarse a futuras necesidades, como integraci√≥n con sistemas externos de gesti√≥n o la ampliaci√≥n de funcionalidades para gestionar inventarios en m√∫ltiples ubicaciones.

---

## Patr√≥n de Asignaci√≥n

### T√≠tulo
Despliegue basado en microservicios para garantizar flexibilidad y escalabilidad del m√≥dulo de Inventarios

### Contexto
El m√≥dulo de Inventarios es uno de los componentes m√°s din√°micos del sistema, ya que registra movimientos constantes (entradas, salidas, consumos, ajustes), consulta existencias en tiempo real y se integra con otros m√≥dulos como Compras. Esto implica manejar alta concurrencia, mantener la consistencia del stock y permitir que algunas funcionalidades escalen m√°s r√°pido que otras. Para soportar esta variabilidad operativa, se requiere un modelo de despliegue independiente y f√°cilmente escalable.

### Alternativas

- **Single-tier / Monolito**: Sencillo de desplegar, pero limita el crecimiento y provoca cuellos de botella cuando la carga aumenta.
- **Arquitectura Multi-Tier**: Separa responsabilidades, pero mantiene el m√≥dulo como una unidad indivisible, dificultando escalar funciones espec√≠ficas sin aumentar el resto.
- **Microservicios**: Permite dividir el m√≥dulo en componentes peque√±os desplegados de forma independiente, optimizando carga, rendimiento y mantenimiento.

### Criterios de elecci√≥n

- Necesidad de escalar de forma independiente consultas de stock, generaci√≥n de alertas y procesamiento de movimientos.
- Reducci√≥n del impacto entre fallos (una falla en movimientos no detiene las consultas de inventario).
- Integraci√≥n fluida con m√≥dulos externos mediante APIs o eventos.
- Compatibilidad con entornos de nube y orquestaci√≥n basada en contenedores.

### Decisi√≥n
Adoptar un modelo de **microservicios**, separando el m√≥dulo de Inventarios en servicios aut√≥nomos:

- **Servicio de Consulta de Inventario**: optimizado para m√°xima disponibilidad, soportando picos de lectura.
- **Servicio de Movimientos de Inventario**: maneja entradas, salidas, ajustes y garantiza transacciones ACID.
- **Servicio de Alertas y Reposiciones**: analiza niveles de stock y genera notificaciones o solicitudes autom√°ticas.
- **Servicio de Cat√°logo de Productos**: administra informaci√≥n est√°tica o semiest√°tica de los √≠tems.

Cada microservicio se desplegar√° en contenedores independientes (Docker/Kubernetes), permitiendo escalar de forma granular seg√∫n la demanda funcional.

### Capa de datos
Cada servicio gestionar√° su propia base de datos o esquemas independientes dentro de la misma instancia, manteniendo una arquitectura **database-per-service** o **schema-per-service**, seg√∫n convenga, para reducir acoplamiento y mejorar confiabilidad.

### Sustento
El enfoque basado en microservicios aumenta la resiliencia del sistema, evita que una sobrecarga en movimientos afecte las consultas y habilita escalabilidad selectiva en las √°reas que lo requieran. Adem√°s, mejora la mantenibilidad al permitir actualizaciones por servicio y facilita integraciones mediante APIs y eventos, lo que resulta especialmente valioso para sincronizar el inventario con operaciones de compras.

---

## Patr√≥n de Dise√±o Cloud

### T√≠tulo
Supervisi√≥n autom√°tica en la nube para detecci√≥n de stock cr√≠tico y productos pr√≥ximos a vencer mediante Scheduler + Agent Supervisor

### Contexto
El m√≥dulo de Inventarios requiere un mecanismo que garantice la detecci√≥n oportuna de situaciones cr√≠ticas como niveles de stock bajos y fechas de vencimiento pr√≥ximas. Estas tareas, adem√°s de ser repetitivas, deben ejecutarse de forma confiable y sin depender de interacci√≥n humana.

Para asegurar continuidad, el sistema debe contar con un proceso automatizado que revise el inventario peri√≥dicamente, genere alertas y notifique a m√≥dulos como Compras o Gesti√≥n Cl√≠nica.

Con una infraestructura basada en la nube, resulta conveniente delegar estas tareas a servicios gestionados que aseguren disponibilidad, monitoreo y ejecuci√≥n programada sin necesidad de administrar servidores dedicados.

### Alternativas

#### 1. Supervisi√≥n manual por el personal operativo

**Ventajas:**
- No requiere implementaci√≥n t√©cnica adicional.
- Control directo por parte del usuario.

**Desventajas:**
- Altamente propenso a errores y omisiones.
- No escala con grandes vol√∫menes de productos.
- Alto riesgo de desabastecimiento o vencimientos no detectados.

#### 2. Tareas programadas locales (cron jobs en el servidor)

**Ventajas:**
- Simple de configurar en entornos tradicionales.
- Sin costo adicional por servicio cloud.

**Desventajas:**
- Dependencia del servidor local: si cae, no corre la tarea.
- Escalabilidad limitada; mala pr√°ctica en arquitecturas distribuidas.
- Dificultad para monitorear ejecuci√≥n y fallos.

#### 3. Patr√≥n Cloud Scheduler + Agent Supervisor (operaci√≥n aut√≥noma en la nube)

**Ventajas:**
- Ejecuci√≥n garantizada y distribuida, incluso si el backend no est√° disponible.
- Monitoreo nativo, alertas de fallos y manejo de reintentos.
- Escalable, seguro y desacoplado del servidor de aplicaci√≥n.
- Ideal para tareas recurrentes como revisiones de inventario.

**Desventajas:**
- Requiere integraci√≥n inicial con servicios cloud.
- Depende de conectividad al proveedor (Google Cloud, AWS, Azure).

### Criterios de elecci√≥n

- Necesidad de un proceso de supervisi√≥n automatizada y confiable.
- Minimizar el riesgo de inventario insuficiente o productos vencidos.
- Evitar cargas adicionales sobre el backend principal.
- Desacoplar procesos temporales de la l√≥gica central del m√≥dulo.
- Trazabilidad, logs y monitoreo unificado de las tareas.
- Adaptabilidad a entornos cloud y contenedores.

### Decisi√≥n

Se selecciona el patr√≥n **Cloud Scheduler + Agent Supervisor**, implementando un flujo donde:

- **Cloud Scheduler** ejecuta revisiones programadas del inventario (por ejemplo, cada hora o seg√∫n pol√≠ticas de la cl√≠nica).
- Un **Agent Supervisor** (funci√≥n serverless o microservicio ligero) procesa:
  - Verificaci√≥n de stock bajo.
  - Identificaci√≥n de productos pr√≥ximos a vencer.
  - Generaci√≥n de alertas y env√≠o de notificaciones a Compras, Gesti√≥n de Riesgos o Dashboard.

El agente consulta la base de datos de inventarios, eval√∫a reglas de negocio y emite eventos sin impactar la operaci√≥n del backend principal.

### Sustento

Este patr√≥n permite un monitoreo continuo del inventario sin depender del backend, garantizando que las tareas cr√≠ticas se ejecuten incluso durante mantenimientos o picos de carga.

La nube aporta herramientas de programaci√≥n confiables, con alta disponibilidad, tolerancia a fallos y ejecuci√≥n distribuida que asegura que el proceso no se detenga.

Asimismo, el Agent Supervisor opera de manera aislada, lo que facilita ajustes en las reglas de stock o pol√≠ticas de vencimientos sin afectar el resto del sistema.


---

[‚¨ÖÔ∏è Anterior](../8.3/8.3.md) | [üè† Home](../../README.md) | [Siguiente ‚û°Ô∏è](../8.5/8.5.md)