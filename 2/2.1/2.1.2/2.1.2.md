# 2.1.2. Módulo 2  
## Compras

### Descripción general
Este módulo gestiona de punta a punta el abastecimiento de la clínica: **proveedores → órdenes de compra (OC) → recepción → conciliación con facturas**. Su propósito es asegurar trazabilidad, control de condiciones comerciales y alineación con **Inventario Médico** para evitar quiebres de stock y sobrecompras.

---

### 2.1.2.1 Gestión de Proveedores

**Descripción:**  
Administra el **maestro de proveedores**, condiciones de pago, tiempos de entrega, contacto y estado (activo/inactivo). Permite homologación básica (documentación y cumplimiento).

#### Requerimientos Funcionales

| ID | Nombre | Historia de Usuario |
|----|-------|---------------------|
| **RF2-1** | Alta de Proveedor | **Como** Encargado de Compras, **quiero** registrar un nuevo proveedor con razón social, RUC/ID, contacto y rubros, **para** habilitarlo en el proceso de compra. |
| **RF2-2** | Edición de Proveedor | **Como** Encargado de Compras, **quiero** actualizar datos de un proveedor (contacto, banco, plazos), **para** mantener su información vigente. |
| **RF2-3** | Estados del Proveedor | **Como** Administrador/Compras, **quiero** activar/inactivar proveedores, **para** bloquear compras a proveedores observados. |
| **RF2-4** | Condiciones Comerciales | **Como** Compras, **quiero** registrar condiciones de pago (contado/30/45 días), incoterms locales y tiempos de entrega, **para** estandarizar acuerdos. |
| **RF2-5** | Homologación Básica | **Como** Compras, **quiero** adjuntar y verificar documentos (RUC, licencias sanitarias), **para** cumplir requisitos de auditoría. |

---

### 2.1.2.2 Catálogo y Lista de Materiales (integrado con Inventario)

**Descripción:**  
Permite consultar el **catálogo de insumos/medicamentos** (con códigos, lotes, UM, stock, costo estimado) y armar listas de compra.

#### Requerimientos Funcionales

| ID | Nombre | Historia de Usuario |
|----|-------|---------------------|
| **RF2-6** | Consulta de Catálogo | **Como** Compras, **quiero** buscar insumos por código, nombre o categoría, **para** agregarlos a solicitudes/OC. |
| **RF2-7** | Precios de Referencia | **Como** Compras, **quiero** ver el último precio comprado por ítem y proveedor, **para** comparar ofertas. |
| **RF2-8** | Sugerencia por Stock Mínimo | **Como** Compras, **quiero** ver sugerencias de compra según stock mínimo y consumo histórico, **para** evitar quiebres. |

---

### 2.1.2.3 Solicitudes de Compra

**Descripción:**  
Registro de **Solicitudes de Compra (SC)** originadas por áreas (enfermería, farmacia, laboratorio).

#### Requerimientos Funcionales

| ID | Nombre | Historia de Usuario |
|----|-------|---------------------|
| **RF2-9** | Crear Solicitud | **Como** usuario de área, **quiero** crear una SC con ítems y cantidades, **para** iniciar el proceso de compra. |
| **RF2-10** | Aprobación de SC | **Como** Jefe de Área, **quiero** aprobar/rechazar SC, **para** controlar el gasto. |
| **RF2-11** | Conversión SC→OC | **Como** Compras, **quiero** convertir SC aprobadas en una o varias OC, **para** agilizar el proceso. |

---

### 2.1.2.4 Órdenes de Compra (OC)

**Descripción:**  
Creación y seguimiento de **OC** con proveedor, condiciones, ítems, precios, impuestos y fechas prometidas.

#### Requerimientos Funcionales

| ID | Nombre | Historia de Usuario |
|----|-------|---------------------|
| **RF2-12** | Crear OC | **Como** Compras, **quiero** generar una OC con proveedor, ítems, cantidades, precio y fecha de entrega, **para** formalizar la compra. |
| **RF2-13** | Aprobación de OC | **Como** Responsable autorizado, **quiero** aprobar/rechazar OC según monto y reglas, **para** controlar compromisos. |
| **RF2-14** | Versionado/Enmiendas | **Como** Compras, **quiero** emitir enmiendas de OC con control de versión, **para** documentar cambios de precio o cantidad. |
| **RF2-15** | Estados de OC | **Como** Compras, **quiero** gestionar estados (Borrador, En revisión, Aprobada, Enviada, Parcialmente recibida, Completada, Cancelada), **para** dar seguimiento. |
| **RF2-16** | Envío al Proveedor | **Como** Compras, **quiero** enviar la OC al proveedor por email/PDF y registrar acuse, **para** dejar constancia. |
| **RF2-17** | Multimoneda/Impuestos | **Como** Compras, **quiero** registrar moneda, tipo de cambio e impuestos por ítem o total, **para** reflejar el costo real. |

---

### 2.1.2.5 Recepción de Mercadería

**Descripción:**  
Registro de **ingresos al almacén** contra OC, con soporte de **recepciones parciales** y control de calidad básico.

#### Requerimientos Funcionales

| ID | Nombre | Historia de Usuario |
|----|-------|---------------------|
| **RF2-18** | Recepción Parcial | **Como** Almacén, **quiero** registrar recepciones parciales por OC/ítem, **para** actualizar stock progresivamente. |
| **RF2-19** | Verificación de Ítems | **Como** Almacén, **quiero** verificar cantidades, UM, lotes y fechas de caducidad, **para** asegurar conformidad. |
| **RF2-20** | Rechazo/Devolución | **Como** Almacén, **quiero** rechazar ítems defectuosos y generar nota de devolución, **para** mantener la calidad. |
| **RF2-21** | Documentos de Recepción | **Como** Almacén, **quiero** emitir un comprobante de recepción (RR) asociado a la OC, **para** auditar el ingreso. |

---

### 2.1.2.6 Conciliación con Facturas

**Descripción:**  
Conciliación **OC ↔ Recepción ↔ Factura** con tolerancias configurables (precio/cantidad).

#### Requerimientos Funcionales

| ID | Nombre | Historia de Usuario |
|----|-------|---------------------|
| **RF2-22** | Registro de Factura | **Como** Contabilidad/Compras, **quiero** registrar facturas del proveedor referenciando la OC, **para** habilitar su pago. |
| **RF2-23** | 3-Way Match | **Como** Compras, **quiero** conciliar precio y cantidad entre OC, recepción y factura, **para** evitar pagos indebidos. |
| **RF2-24** | Tolerancias | **Como** Administrador, **quiero** configurar tolerancias de diferencia (±% precio, ±% cantidad), **para** automatizar aprobaciones. |
| **RF2-25** | Alertas de Desviación | **Como** Compras, **quiero** recibir alertas cuando la conciliación falle, **para** resolver incidencias rápidamente. |

---

### 2.1.2.7 Integraciones con Inventario y Notificaciones

**Descripción:**  
Sincroniza **movimientos de inventario** y envía **notificaciones** a usuarios involucrados.

#### Requerimientos Funcionales

| ID | Nombre | Historia de Usuario |
|----|-------|---------------------|
| **RF2-26** | Actualización de Stock | **Como** Sistema, **quiero** actualizar stock disponible al registrar una recepción, **para** reflejar el inventario real. |
| **RF2-27** | Consumo vs Compra | **Como** Compras, **quiero** ver consumo histórico por ítem y área, **para** planificar compras. |
| **RF2-28** | Notificaciones de Estado | **Como** Usuario, **quiero** recibir notificaciones al aprobar OC, al llegar mercadería o ante retrasos, **para** estar informado. |

---

### 2.1.2.8 Reportes y Auditoría

**Descripción:**  
Indicadores y trazabilidad de operaciones.

#### Requerimientos Funcionales

| ID | Nombre | Historia de Usuario |
|----|-------|---------------------|
| **RF2-29** | Reporte de OC | **Como** Director/Analista, **quiero** ver reportes por proveedor, categoría e ítem (monto, plazos, estado), **para** analizar gastos. |
| **RF2-30** | Backorder y Atrasos | **Como** Compras, **quiero** ver OC con atraso vs fecha prometida, **para** gestionar a proveedores. |
| **RF2-31** | Trazabilidad Completa | **Como** Auditor, **quiero** consultar el rastro de una OC (quién creó, aprobó, recibió, facturó), **para** cumplir auditorías. |

---

### 2.1.2.9 Configuración y Reglas de Negocio

**Descripción:**  
Parámetros que gobiernan el comportamiento del módulo.

#### Requerimientos Funcionales

| ID | Nombre | Historia de Usuario |
|----|-------|---------------------|
| **RF2-32** | Reglas de Aprobación | **Como** Administrador, **quiero** definir niveles de aprobación por montos o categorías, **para** controlar riesgos. |
| **RF2-33** | Calendario y Plazos | **Como** Compras, **quiero** configurar días hábiles y plazos de entrega por proveedor, **para** planificar recepciones. |
| **RF2-34** | Moneda y Impuestos | **Como** Administrador, **quiero** definir monedas, tipos de cambio e impuestos por país/región, **para** correcta valoración. |
| **RF2-35** | Tolerancias Globales | **Como** Administrador, **quiero** establecer tolerancias por defecto para 3-way match, **para** uniformar criterios. |

---