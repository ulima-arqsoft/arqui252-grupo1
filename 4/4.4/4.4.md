> [4. Decisiones Iniciales de Arquitectura](../4.md) ‚Ä∫ [4.4. M√≥dulo 4 / Integrante 4](4.4.md)

# 4.4. M√≥dulo 4 ‚Äì Inventario M√©dico

## Decisi√≥n 1: Asignaci√≥n de Responsabilidades

| Campo | Descripci√≥n |
|--------|-------------|
| **T√≠tulo** | Modelo funcional del M√≥dulo 4: Inventario M√©dico (almac√©n √∫nico) |
| **Contexto** | El m√≥dulo gestiona medicamentos e insumos m√©dicos desde un √∫nico almac√©n centralizado. Administra entradas, salidas, consumos por √°reas asistenciales y alertas de stock y vencimiento. |
| **Alternativas** | A1: L√≥gica concentrada en un √∫nico servicio.<br>A2: Dividir en subm√≥dulos funcionales internos.<br>A3: Dividir en microservicios independientes. |
| **Criterios de Elecci√≥n** | Modularidad, mantenibilidad, simplicidad operativa, consistencia transaccional, trazabilidad. |
| **Decisi√≥n** | Se adopta A2: separaci√≥n interna l√≥gica en subm√≥dulos (Cat√°logo, Stock, Alertas), manteniendo cohesi√≥n como parte del ERP. |
| **Sustento** | Evita alta complejidad de microservicios y favorece evoluci√≥n ordenada con alta trazabilidad del inventario. |

---

## Decisi√≥n 2: Modelo de Coordinaci√≥n

| Campo | Descripci√≥n |
|--------|-------------|
| **T√≠tulo** | Coordinaci√≥n h√≠brida sincr√≥nica/as√≠ncrona |
| **Contexto** | Las operaciones cr√≠ticas como actualizar stock requieren consistencia inmediata. Las notificaciones y auditor√≠a son tareas posteriores. |
| **Alternativas** | A1: Comunicaci√≥n 100% sincr√≥nica.<br>A2: As√≠ncrona por eventos.<br>A3: Modelo h√≠brido. |
| **Criterios de Elecci√≥n** | Rendimiento, consistencia, disponibilidad ante fallos externos. |
| **Decisi√≥n** | Se adopta modelo h√≠brido: REST sincr√≥nico para stock cr√≠tico y eventos as√≠ncronos RabbitMQ para alertas/logs. |
| **Sustento** | Minimiza latencia del usuario sin sacrificar integridad ni trazabilidad del inventario. |

---

## Decisi√≥n 3: Modelo de Datos

| Campo | Descripci√≥n |
|--------|-------------|
| **T√≠tulo** | PostgreSQL relacional con JSONB |
| **Contexto** | Se requiere consistencia estricta y trazabilidad de movimientos (k√°rdex) con metadatos variables. |
| **Alternativas** | A1: Relacional puro.<br>A2: NoSQL.<br>A3: Relacional + JSON. |
| **Criterios** | ACID, consultas r√°pidas, flexibilidad. |
| **Decisi√≥n** | PostgreSQL normalizado con campos JSONB para extensibilidad. |
| **Sustento** | Balancea consistencia y flexibilidad sin perder rendimiento. |

---

## Decisi√≥n 4: Mapeo Arquitect√≥nico

| Campo | Descripci√≥n |
|--------|-------------|
| **T√≠tulo** | Arquitectura modular por capas |
| **Contexto** | El m√≥dulo debe integrarse con Compras, Seguridad y Pacientes. |
| **Alternativas** | A1: Monolito no estructurado.<br>A2: Microservicios.<br>A3: Monolito modular. |
| **Decisi√≥n** | A3 ‚Äì Modular Monolith con separaci√≥n por capas (API ‚Üí Aplicaci√≥n ‚Üí Dominio ‚Üí Infraestructura). |
| **Sustento** | Facilita pruebas, mantenibilidad y futuras extracciones de componentes. |

---

## Decisi√≥n 5: Selecci√≥n Tecnol√≥gica

| Campo | Descripci√≥n |
|--------|-------------|
| **T√≠tulo** | Tecnolog√≠as para Inventario M√©dico |
| **Backend** | TypeScript + NestJS |
| **BD** | PostgreSQL + Prisma ORM |
| **Cache** | Redis (mejora consultas repetidas y locking distribuido) |
| **Mensajer√≠a** | RabbitMQ (eventos de alerta/actualizaci√≥n) |
| **Seguridad** | JWT + Roles RBAC + Logs de auditor√≠a |
| **Despliegue** | Docker + Kubernetes |
| **Sustento** | Compatible con arquitectura del ERP, f√°cil de escalar, probado en entorno productivo. |

---

[‚¨ÖÔ∏è Anterior](../4.3/4.3.md) | [üè† Home](../../README.md) | [Siguiente ‚û°Ô∏è](../4.5/4.5.md)